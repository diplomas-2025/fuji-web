{"ast":null,"code":"import React,{useEffect}from'react';import axios from'axios';import Info from'../Info';import{useCart}from'../../hooks/useCart';import styles from'./Drawer.module.scss';import{API_BASE_URL}from\"../../pages/AuthPage\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const delay=ms=>new Promise(resolve=>setTimeout(resolve,ms));function Drawer(_ref){let{onClose,onRemove,items=[],opened}=_ref;const{cartItems,setCartItems,totalPrice}=useCart();const[orderId,setOrderId]=React.useState(null);const[isOrderComplete,setIsOrderComplete]=React.useState(false);const[isLoading,setIsLoading]=React.useState(false);const[address,setAddress]=React.useState(\"\");const onClickOrder=async()=>{try{setIsLoading(true);const{data}=await axios.post(API_BASE_URL+'/foods/order?address='+address,null,{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}});setOrderId(data.id);setIsOrderComplete(true);setCartItems([]);}catch(error){alert('Ошибка при создании заказа :(');}setIsLoading(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(styles.overlay,\" \").concat(opened?styles.overlayVisible:''),children:/*#__PURE__*/_jsxs(\"div\",{className:styles.drawer,children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"d-flex justify-between mb-30\",children:[\"\\u041A\\u043E\\u0440\\u0437\\u0438\\u043D\\u0430 \",/*#__PURE__*/_jsx(\"img\",{onClick:onClose,className:\"cu-p\",src:\"img/btn-remove.svg\",alt:\"Close\"})]}),items.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column flex\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"items flex\",children:items.map(obj=>/*#__PURE__*/_jsxs(\"div\",{className:\"cartItem d-flex align-center mb-20\",children:[/*#__PURE__*/_jsx(\"div\",{style:{backgroundImage:\"url(\".concat(obj.image,\")\")},className:\"cartItemImg\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mr-20 flex\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-5\",children:obj.title}),/*#__PURE__*/_jsxs(\"b\",{children:[obj.price,\" \\u0440\\u0443\\u0431.\"]})]})]},obj.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-floating\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",id:\"address\",placeholder:\"\\u0410\\u0434\\u0440\\u0435\\u0441\",value:address,onChange:event=>setAddress(event.target.value)}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"address\",children:\"\\u0410\\u0434\\u0440\\u0435\\u0441\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"cartTotalBlock\",children:[/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0418\\u0442\\u043E\\u0433\\u043E:\"}),/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[totalPrice,\" \\u0440\\u0443\\u0431. \"]})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u041D\\u0430\\u043B\\u043E\\u0433 5%:\"}),/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"b\",{children:[totalPrice/100*5,\" \\u0440\\u0443\\u0431. \"]})]})]}),/*#__PURE__*/_jsxs(\"button\",{disabled:isLoading,onClick:onClickOrder,className:\"greenButton\",children:[\"\\u041E\\u0444\\u043E\\u0440\\u043C\\u0438\\u0442\\u044C \\u0437\\u0430\\u043A\\u0430\\u0437 \",/*#__PURE__*/_jsx(\"img\",{src:\"img/arrow.svg\",alt:\"Arrow\"})]})]})]}):/*#__PURE__*/_jsx(Info,{title:isOrderComplete?'Заказ оформлен!':'Корзина пустая',description:isOrderComplete?\"\\u0412\\u0430\\u0448 \\u0437\\u0430\\u043A\\u0430\\u0437 \\u0441\\u043A\\u043E\\u0440\\u043E \\u0431\\u0443\\u0434\\u0435\\u0442 \\u043F\\u0435\\u0440\\u0435\\u0434\\u0430\\u043D \\u043A\\u0443\\u0440\\u044C\\u0435\\u0440\\u0441\\u043A\\u043E\\u0439 \\u0434\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0435\":'Добавьте хотя бы одно блюдо, чтобы сделать заказ.',image:isOrderComplete?'img/complete-order.jpg':'img/empty-cart.jpg'})]})});}export default Drawer;","map":{"version":3,"names":["React","useEffect","axios","Info","useCart","styles","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","delay","ms","Promise","resolve","setTimeout","Drawer","_ref","onClose","onRemove","items","opened","cartItems","setCartItems","totalPrice","orderId","setOrderId","useState","isOrderComplete","setIsOrderComplete","isLoading","setIsLoading","address","setAddress","onClickOrder","data","post","headers","localStorage","getItem","id","error","alert","className","concat","overlay","overlayVisible","children","drawer","onClick","src","alt","length","map","obj","style","backgroundImage","image","title","price","type","placeholder","value","onChange","event","target","htmlFor","disabled","description"],"sources":["/Users/danilabelakov/WebstormProjects/fuji-web/src/components/Drawer/index.js"],"sourcesContent":["import React, {useEffect} from 'react';\nimport axios from 'axios';\n\nimport Info from '../Info';\nimport { useCart } from '../../hooks/useCart';\n\nimport styles from './Drawer.module.scss';\nimport {API_BASE_URL} from \"../../pages/AuthPage\";\n\nconst delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\n\nfunction Drawer({ onClose, onRemove, items = [], opened }) {\n  const { cartItems, setCartItems, totalPrice } = useCart();\n  const [orderId, setOrderId] = React.useState(null);\n  const [isOrderComplete, setIsOrderComplete] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(false);\n  const [address, setAddress] = React.useState(\"\")\n\n  const onClickOrder = async () => {\n    try {\n      setIsLoading(true);\n      const { data } = await axios.post(API_BASE_URL + '/foods/order?address=' + address, null, {\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n        }\n      });\n      setOrderId(data.id);\n      setIsOrderComplete(true);\n      setCartItems([]);\n    } catch (error) {\n      alert('Ошибка при создании заказа :(');\n    }\n    setIsLoading(false);\n  };\n\n  return (\n    <div className={`${styles.overlay} ${opened ? styles.overlayVisible : ''}`}>\n      <div className={styles.drawer}>\n        <h2 className=\"d-flex justify-between mb-30\">\n          Корзина <img onClick={onClose} className=\"cu-p\" src=\"img/btn-remove.svg\" alt=\"Close\" />\n        </h2>\n\n        {items.length > 0 ? (\n            <div className=\"d-flex flex-column flex\">\n              <div className=\"items flex\">\n                {items.map((obj) => (\n                    <div key={obj.id} className=\"cartItem d-flex align-center mb-20\">\n                      <div\n                          style={{backgroundImage: `url(${obj.image})`}}\n                          className=\"cartItemImg\"></div>\n\n                      <div className=\"mr-20 flex\">\n                        <p className=\"mb-5\">{obj.title}</p>\n                        <b>{obj.price} руб.</b>\n                      </div>\n                      {/*<img*/}\n                      {/*  onClick={() => onRemove(obj.id)}*/}\n                      {/*  className=\"removeBtn\"*/}\n                      {/*  src=\"img/btn-remove.svg\"*/}\n                      {/*  alt=\"Remove\"*/}\n                      {/*/>*/}\n                    </div>\n                ))}\n              </div>\n              <div className=\"form-floating\">\n                <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    id=\"address\"\n                    placeholder=\"Адрес\"\n                    value={address}\n                    onChange={event => setAddress(event.target.value)}\n                />\n                <label htmlFor=\"address\">Адрес</label>\n              </div>\n              <div className=\"cartTotalBlock\">\n                <ul>\n                  <li>\n                    <span>Итого:</span>\n                    <div></div>\n                    <b>{totalPrice} руб. </b>\n                  </li>\n                  <li>\n                    <span>Налог 5%:</span>\n                    <div></div>\n                    <b>{(totalPrice / 100) * 5} руб. </b>\n                  </li>\n                </ul>\n                <button disabled={isLoading} onClick={onClickOrder} className=\"greenButton\">\n                  Оформить заказ <img src=\"img/arrow.svg\" alt=\"Arrow\"/>\n                </button>\n              </div>\n            </div>\n        ) : (\n            <Info\n                title={isOrderComplete ? 'Заказ оформлен!' : 'Корзина пустая'}\n                description={\n                  isOrderComplete\n                      ? `Ваш заказ скоро будет передан курьерской доставке`\n                      : 'Добавьте хотя бы одно блюдо, чтобы сделать заказ.'\n                }\n                image={isOrderComplete ? 'img/complete-order.jpg' : 'img/empty-cart.jpg'}\n            />\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default Drawer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}