{"ast":null,"code":"import _objectSpread from\"/Users/danilabelakov/WebstormProjects/fuji-web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React from'react';import{BrowserRouter,Route,Routes}from'react-router-dom';import axios from'axios';import Header from'./components/Header';import Drawer from'./components/Drawer';import AppContext from'./context';import Home from'./pages/Home';import Favorites from'./pages/Favorites';import Orders from'./pages/Orders';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[items,setItems]=React.useState([]);const[cartItems,setCartItems]=React.useState([]);const[favorites,setFavorites]=React.useState([]);const[searchValue,setSearchValue]=React.useState('');const[cartOpened,setCartOpened]=React.useState(false);const[isLoading,setIsLoading]=React.useState(true);React.useEffect(()=>{async function fetchData(){try{const[cartResponse,favoritesResponse,itemsResponse]=await Promise.all([axios.get('http://128.73.229.244:5003/foods/cards',{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}}),axios.get('http://128.73.229.244:5003/foods/favorites',{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}}),axios.get('http://128.73.229.244:5003/foods',{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}})]);setIsLoading(false);setCartItems(cartResponse.data);setFavorites(favoritesResponse.data);setItems(itemsResponse.data);}catch(error){alert('Ошибка при запросе данных ;(');console.error(error);}}fetchData();},[]);const onAddToCart=async obj=>{try{const findItem=cartItems.find(item=>Number(item.parentId)===Number(obj.id));if(findItem){setCartItems(prev=>prev.filter(item=>Number(item.parentId)!==Number(obj.id)));await axios.delete(\"http://128.73.229.244:5003/foods/\".concat(findItem.id,\"/card\"),{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}});}else{setCartItems(prev=>[...prev,obj]);const{data}=await axios.post(\"http://128.73.229.244:5003/foods/\".concat(obj.id,\"/card\"),null,{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}});setCartItems(prev=>prev.map(item=>{if(item.parentId===data.parentId){return _objectSpread(_objectSpread({},item),{},{id:data.id});}return item;}));}}catch(error){alert('Ошибка при добавлении в корзину');console.error(error);}};const onRemoveItem=id=>{try{axios.delete(\"http://128.73.229.244:5003/foods/\".concat(id,\"/favorite\"),{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}});setCartItems(prev=>prev.filter(item=>Number(item.id)!==Number(id)));}catch(error){alert('Ошибка при удалении из корзины');console.error(error);}};const onAddToFavorite=async obj=>{try{if(favorites.find(favObj=>Number(favObj.id)===Number(obj.id))){axios.delete(\"http://128.73.229.244:5003/foods/\".concat(obj.id,\"/favorite\"),{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}});setFavorites(prev=>prev.filter(item=>Number(item.id)!==Number(obj.id)));}else{const{data}=await axios.post(\"http://128.73.229.244:5003/foods/\".concat(obj.id,\"/favorite\"),obj,{headers:{'Authorization':'Bearer '+localStorage.getItem('access_token')}});setFavorites(prev=>[...prev,data]);}}catch(error){alert('Не удалось добавить в фавориты');console.error(error);}};const onChangeSearchInput=event=>{setSearchValue(event.target.value);};const isItemAdded=id=>{return cartItems.some(obj=>Number(obj.parentId)===Number(id));};return/*#__PURE__*/_jsx(AppContext.Provider,{value:{items,cartItems,favorites,isItemAdded,onAddToFavorite,onAddToCart,setCartOpened,setCartItems},children:/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper clear\",children:[/*#__PURE__*/_jsx(Drawer,{items:cartItems,onClose:()=>setCartOpened(false),onRemove:onRemoveItem,opened:cartOpened}),/*#__PURE__*/_jsx(Header,{onClickCart:()=>setCartOpened(true)}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{items:items,cartItems:cartItems,searchValue:searchValue,setSearchValue:setSearchValue,onChangeSearchInput:onChangeSearchInput,onAddToFavorite:onAddToFavorite,onAddToCart:onAddToCart,isLoading:isLoading})}),/*#__PURE__*/_jsx(Route,{path:\"/favorites\",element:/*#__PURE__*/_jsx(Favorites,{})}),/*#__PURE__*/_jsx(Route,{path:\"/orders\",element:/*#__PURE__*/_jsx(Orders,{})})]})]})})});}export default App;","map":{"version":3,"names":["React","BrowserRouter","Route","Routes","axios","Header","Drawer","AppContext","Home","Favorites","Orders","jsx","_jsx","jsxs","_jsxs","App","items","setItems","useState","cartItems","setCartItems","favorites","setFavorites","searchValue","setSearchValue","cartOpened","setCartOpened","isLoading","setIsLoading","useEffect","fetchData","cartResponse","favoritesResponse","itemsResponse","Promise","all","get","headers","localStorage","getItem","data","error","alert","console","onAddToCart","obj","findItem","find","item","Number","parentId","id","prev","filter","delete","concat","post","map","_objectSpread","onRemoveItem","onAddToFavorite","favObj","onChangeSearchInput","event","target","value","isItemAdded","some","Provider","children","className","onClose","onRemove","opened","onClickCart","path","element"],"sources":["/Users/danilabelakov/WebstormProjects/fuji-web/src/App.js"],"sourcesContent":["import React from 'react';\nimport {BrowserRouter, Route, Routes} from 'react-router-dom';\nimport axios from 'axios';\nimport Header from './components/Header';\nimport Drawer from './components/Drawer';\nimport AppContext from './context';\n\nimport Home from './pages/Home';\nimport Favorites from './pages/Favorites';\nimport Orders from './pages/Orders';\n\nfunction App() {\n  const [items, setItems] = React.useState([]);\n  const [cartItems, setCartItems] = React.useState([]);\n  const [favorites, setFavorites] = React.useState([]);\n  const [searchValue, setSearchValue] = React.useState('');\n  const [cartOpened, setCartOpened] = React.useState(false);\n  const [isLoading, setIsLoading] = React.useState(true);\n\n  React.useEffect(() => {\n    async function fetchData() {\n      try {\n        const [cartResponse, favoritesResponse, itemsResponse] = await Promise.all([\n          axios.get('http://128.73.229.244:5003/foods/cards', {\n            headers: {\n              'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n            }\n          }),\n          axios.get('http://128.73.229.244:5003/foods/favorites', {\n            headers: {\n              'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n            }\n          }),\n          axios.get('http://128.73.229.244:5003/foods', {\n            headers: {\n              'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n            }\n          }),\n        ]);\n\n        setIsLoading(false);\n        setCartItems(cartResponse.data);\n        setFavorites(favoritesResponse.data);\n        setItems(itemsResponse.data);\n      } catch (error) {\n        alert('Ошибка при запросе данных ;(');\n        console.error(error);\n      }\n    }\n\n    fetchData();\n  }, []);\n\n  const onAddToCart = async (obj) => {\n    try {\n      const findItem = cartItems.find((item) => Number(item.parentId) === Number(obj.id));\n      if (findItem) {\n        setCartItems((prev) => prev.filter((item) => Number(item.parentId) !== Number(obj.id)));\n        await axios.delete(`http://128.73.229.244:5003/foods/${findItem.id}/card`, {\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n          }\n        });\n      } else {\n        setCartItems((prev) => [...prev, obj]);\n        const { data } = await axios.post(`http://128.73.229.244:5003/foods/${obj.id}/card`, null, {\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n          }\n        });\n        setCartItems((prev) =>\n          prev.map((item) => {\n            if (item.parentId === data.parentId) {\n              return {\n                ...item,\n                id: data.id,\n              };\n            }\n            return item;\n          }),\n        );\n      }\n    } catch (error) {\n      alert('Ошибка при добавлении в корзину');\n      console.error(error);\n    }\n  };\n\n  const onRemoveItem = (id) => {\n    try {\n      axios.delete(`http://128.73.229.244:5003/foods/${id}/favorite`, {\n        headers: {\n          'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n        }\n      });\n      setCartItems((prev) => prev.filter((item) => Number(item.id) !== Number(id)));\n    } catch (error) {\n      alert('Ошибка при удалении из корзины');\n      console.error(error);\n    }\n  };\n\n  const onAddToFavorite = async (obj) => {\n    try {\n      if (favorites.find((favObj) => Number(favObj.id) === Number(obj.id))) {\n        axios.delete(`http://128.73.229.244:5003/foods/${obj.id}/favorite`, {\n          headers: {\n            'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n          }\n        });\n        setFavorites((prev) => prev.filter((item) => Number(item.id) !== Number(obj.id)));\n      } else {\n        const { data } = await axios.post(\n            `http://128.73.229.244:5003/foods/${obj.id}/favorite`,\n            obj,\n            {\n              headers: {\n                'Authorization': 'Bearer ' + localStorage.getItem('access_token')\n              }\n            }\n        );\n        setFavorites((prev) => [...prev, data]);\n      }\n    } catch (error) {\n      alert('Не удалось добавить в фавориты');\n      console.error(error);\n    }\n  };\n\n  const onChangeSearchInput = (event) => {\n    setSearchValue(event.target.value);\n  };\n\n  const isItemAdded = (id) => {\n    return cartItems.some((obj) => Number(obj.parentId) === Number(id));\n  };\n\n  return (\n    <AppContext.Provider\n      value={{\n        items,\n        cartItems,\n        favorites,\n        isItemAdded,\n        onAddToFavorite,\n        onAddToCart,\n        setCartOpened,\n        setCartItems,\n      }}>\n      <BrowserRouter>\n        <div className=\"wrapper clear\">\n          <Drawer\n              items={cartItems}\n              onClose={() => setCartOpened(false)}\n              onRemove={onRemoveItem}\n              opened={cartOpened}\n          />\n\n          <Header onClickCart={() => setCartOpened(true)}/>\n\n          <Routes>\n            <Route path=\"/\" element={\n              <Home\n                  items={items}\n                  cartItems={cartItems}\n                  searchValue={searchValue}\n                  setSearchValue={setSearchValue}\n                  onChangeSearchInput={onChangeSearchInput}\n                  onAddToFavorite={onAddToFavorite}\n                  onAddToCart={onAddToCart}\n                  isLoading={isLoading}\n              />\n            }/>\n\n            <Route path=\"/favorites\" element={\n              <Favorites/>\n            }/>\n\n            <Route path=\"/orders\" element={\n              <Orders/>\n            }/>\n          </Routes>\n\n        </div>\n      </BrowserRouter>\n    </AppContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"mIAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAAQC,aAAa,CAAEC,KAAK,CAAEC,MAAM,KAAO,kBAAkB,CAC7D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,MAAM,KAAM,qBAAqB,CACxC,MAAO,CAAAC,UAAU,KAAM,WAAW,CAElC,MAAO,CAAAC,IAAI,KAAM,cAAc,CAC/B,MAAO,CAAAC,SAAS,KAAM,mBAAmB,CACzC,MAAO,CAAAC,MAAM,KAAM,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEpC,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGjB,KAAK,CAACkB,QAAQ,CAAC,EAAE,CAAC,CAC5C,KAAM,CAACC,SAAS,CAAEC,YAAY,CAAC,CAAGpB,KAAK,CAACkB,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACG,SAAS,CAAEC,YAAY,CAAC,CAAGtB,KAAK,CAACkB,QAAQ,CAAC,EAAE,CAAC,CACpD,KAAM,CAACK,WAAW,CAAEC,cAAc,CAAC,CAAGxB,KAAK,CAACkB,QAAQ,CAAC,EAAE,CAAC,CACxD,KAAM,CAACO,UAAU,CAAEC,aAAa,CAAC,CAAG1B,KAAK,CAACkB,QAAQ,CAAC,KAAK,CAAC,CACzD,KAAM,CAACS,SAAS,CAAEC,YAAY,CAAC,CAAG5B,KAAK,CAACkB,QAAQ,CAAC,IAAI,CAAC,CAEtDlB,KAAK,CAAC6B,SAAS,CAAC,IAAM,CACpB,cAAe,CAAAC,SAASA,CAAA,CAAG,CACzB,GAAI,CACF,KAAM,CAACC,YAAY,CAAEC,iBAAiB,CAAEC,aAAa,CAAC,CAAG,KAAM,CAAAC,OAAO,CAACC,GAAG,CAAC,CACzE/B,KAAK,CAACgC,GAAG,CAAC,wCAAwC,CAAE,CAClDC,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACFnC,KAAK,CAACgC,GAAG,CAAC,4CAA4C,CAAE,CACtDC,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACFnC,KAAK,CAACgC,GAAG,CAAC,kCAAkC,CAAE,CAC5CC,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACH,CAAC,CAEFX,YAAY,CAAC,KAAK,CAAC,CACnBR,YAAY,CAACW,YAAY,CAACS,IAAI,CAAC,CAC/BlB,YAAY,CAACU,iBAAiB,CAACQ,IAAI,CAAC,CACpCvB,QAAQ,CAACgB,aAAa,CAACO,IAAI,CAAC,CAC9B,CAAE,MAAOC,KAAK,CAAE,CACdC,KAAK,CAAC,8BAA8B,CAAC,CACrCC,OAAO,CAACF,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAEAX,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAc,WAAW,CAAG,KAAO,CAAAC,GAAG,EAAK,CACjC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG3B,SAAS,CAAC4B,IAAI,CAAEC,IAAI,EAAKC,MAAM,CAACD,IAAI,CAACE,QAAQ,CAAC,GAAKD,MAAM,CAACJ,GAAG,CAACM,EAAE,CAAC,CAAC,CACnF,GAAIL,QAAQ,CAAE,CACZ1B,YAAY,CAAEgC,IAAI,EAAKA,IAAI,CAACC,MAAM,CAAEL,IAAI,EAAKC,MAAM,CAACD,IAAI,CAACE,QAAQ,CAAC,GAAKD,MAAM,CAACJ,GAAG,CAACM,EAAE,CAAC,CAAC,CAAC,CACvF,KAAM,CAAA/C,KAAK,CAACkD,MAAM,qCAAAC,MAAA,CAAqCT,QAAQ,CAACK,EAAE,UAAS,CACzEd,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACJ,CAAC,IAAM,CACLnB,YAAY,CAAEgC,IAAI,EAAK,CAAC,GAAGA,IAAI,CAAEP,GAAG,CAAC,CAAC,CACtC,KAAM,CAAEL,IAAK,CAAC,CAAG,KAAM,CAAApC,KAAK,CAACoD,IAAI,qCAAAD,MAAA,CAAqCV,GAAG,CAACM,EAAE,UAAS,IAAI,CAAE,CACzFd,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACFnB,YAAY,CAAEgC,IAAI,EAChBA,IAAI,CAACK,GAAG,CAAET,IAAI,EAAK,CACjB,GAAIA,IAAI,CAACE,QAAQ,GAAKV,IAAI,CAACU,QAAQ,CAAE,CACnC,OAAAQ,aAAA,CAAAA,aAAA,IACKV,IAAI,MACPG,EAAE,CAAEX,IAAI,CAACW,EAAE,GAEf,CACA,MAAO,CAAAH,IAAI,CACb,CAAC,CACH,CAAC,CACH,CACF,CAAE,MAAOP,KAAK,CAAE,CACdC,KAAK,CAAC,iCAAiC,CAAC,CACxCC,OAAO,CAACF,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAkB,YAAY,CAAIR,EAAE,EAAK,CAC3B,GAAI,CACF/C,KAAK,CAACkD,MAAM,qCAAAC,MAAA,CAAqCJ,EAAE,cAAa,CAC9Dd,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACFnB,YAAY,CAAEgC,IAAI,EAAKA,IAAI,CAACC,MAAM,CAAEL,IAAI,EAAKC,MAAM,CAACD,IAAI,CAACG,EAAE,CAAC,GAAKF,MAAM,CAACE,EAAE,CAAC,CAAC,CAAC,CAC/E,CAAE,MAAOV,KAAK,CAAE,CACdC,KAAK,CAAC,gCAAgC,CAAC,CACvCC,OAAO,CAACF,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAmB,eAAe,CAAG,KAAO,CAAAf,GAAG,EAAK,CACrC,GAAI,CACF,GAAIxB,SAAS,CAAC0B,IAAI,CAAEc,MAAM,EAAKZ,MAAM,CAACY,MAAM,CAACV,EAAE,CAAC,GAAKF,MAAM,CAACJ,GAAG,CAACM,EAAE,CAAC,CAAC,CAAE,CACpE/C,KAAK,CAACkD,MAAM,qCAAAC,MAAA,CAAqCV,GAAG,CAACM,EAAE,cAAa,CAClEd,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CAAC,CAAC,CACFjB,YAAY,CAAE8B,IAAI,EAAKA,IAAI,CAACC,MAAM,CAAEL,IAAI,EAAKC,MAAM,CAACD,IAAI,CAACG,EAAE,CAAC,GAAKF,MAAM,CAACJ,GAAG,CAACM,EAAE,CAAC,CAAC,CAAC,CACnF,CAAC,IAAM,CACL,KAAM,CAAEX,IAAK,CAAC,CAAG,KAAM,CAAApC,KAAK,CAACoD,IAAI,qCAAAD,MAAA,CACOV,GAAG,CAACM,EAAE,cAC1CN,GAAG,CACH,CACER,OAAO,CAAE,CACP,eAAe,CAAE,SAAS,CAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAClE,CACF,CACJ,CAAC,CACDjB,YAAY,CAAE8B,IAAI,EAAK,CAAC,GAAGA,IAAI,CAAEZ,IAAI,CAAC,CAAC,CACzC,CACF,CAAE,MAAOC,KAAK,CAAE,CACdC,KAAK,CAAC,gCAAgC,CAAC,CACvCC,OAAO,CAACF,KAAK,CAACA,KAAK,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAqB,mBAAmB,CAAIC,KAAK,EAAK,CACrCvC,cAAc,CAACuC,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CACpC,CAAC,CAED,KAAM,CAAAC,WAAW,CAAIf,EAAE,EAAK,CAC1B,MAAO,CAAAhC,SAAS,CAACgD,IAAI,CAAEtB,GAAG,EAAKI,MAAM,CAACJ,GAAG,CAACK,QAAQ,CAAC,GAAKD,MAAM,CAACE,EAAE,CAAC,CAAC,CACrE,CAAC,CAED,mBACEvC,IAAA,CAACL,UAAU,CAAC6D,QAAQ,EAClBH,KAAK,CAAE,CACLjD,KAAK,CACLG,SAAS,CACTE,SAAS,CACT6C,WAAW,CACXN,eAAe,CACfhB,WAAW,CACXlB,aAAa,CACbN,YACF,CAAE,CAAAiD,QAAA,cACFzD,IAAA,CAACX,aAAa,EAAAoE,QAAA,cACZvD,KAAA,QAAKwD,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC5BzD,IAAA,CAACN,MAAM,EACHU,KAAK,CAAEG,SAAU,CACjBoD,OAAO,CAAEA,CAAA,GAAM7C,aAAa,CAAC,KAAK,CAAE,CACpC8C,QAAQ,CAAEb,YAAa,CACvBc,MAAM,CAAEhD,UAAW,CACtB,CAAC,cAEFb,IAAA,CAACP,MAAM,EAACqE,WAAW,CAAEA,CAAA,GAAMhD,aAAa,CAAC,IAAI,CAAE,CAAC,CAAC,cAEjDZ,KAAA,CAACX,MAAM,EAAAkE,QAAA,eACLzD,IAAA,CAACV,KAAK,EAACyE,IAAI,CAAC,GAAG,CAACC,OAAO,cACrBhE,IAAA,CAACJ,IAAI,EACDQ,KAAK,CAAEA,KAAM,CACbG,SAAS,CAAEA,SAAU,CACrBI,WAAW,CAAEA,WAAY,CACzBC,cAAc,CAAEA,cAAe,CAC/BsC,mBAAmB,CAAEA,mBAAoB,CACzCF,eAAe,CAAEA,eAAgB,CACjChB,WAAW,CAAEA,WAAY,CACzBjB,SAAS,CAAEA,SAAU,CACxB,CACF,CAAC,CAAC,cAEHf,IAAA,CAACV,KAAK,EAACyE,IAAI,CAAC,YAAY,CAACC,OAAO,cAC9BhE,IAAA,CAACH,SAAS,GAAC,CACZ,CAAC,CAAC,cAEHG,IAAA,CAACV,KAAK,EAACyE,IAAI,CAAC,SAAS,CAACC,OAAO,cAC3BhE,IAAA,CAACF,MAAM,GAAC,CACT,CAAC,CAAC,EACG,CAAC,EAEN,CAAC,CACO,CAAC,CACG,CAAC,CAE1B,CAEA,cAAe,CAAAK,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}